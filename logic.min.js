!function(t){t[t.top=0]="top",t[t.left=1]="left",t[t.right=2]="right",t[t.bottom=3]="bottom"}(DIR||(DIR={}));var DIR,convertDirToString=function(t){switch(t){case DIR.bottom:return"bottom";case DIR.top:return"top";case DIR.right:return"right";case DIR.left:return"left"}},directions=[[1,0],[0,1],[0,-1],[-1,0],],LetterIndex=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],NumberIndex=["1","2","3","4","5","6","7","8","9","10","11","12","14","15","16","17","18","19","20","21","22","23","24","25","26"],createAllLinesFromCell=function(t,r){var e=LetterIndex[r],n=LetterIndex[r+1],c=NumberIndex[t],o=NumberIndex[t+1],i="".concat(e+c,",").concat(e).concat(o),a="".concat(e+o,",").concat(n).concat(o),l="".concat(n+c,",").concat(n).concat(o),u="".concat(e+c,",").concat(n).concat(c);return[i,a,l,u]},getLine=function(t,r,e){var n=[];Array(r).fill(0).forEach(function(t,r){n.push(Array(e).fill(0))});for(var c=Object.keys(t).filter(function(r){return t[r]}),o=0;o<r;o++)for(var i=function(r){var e=0;createAllLinesFromCell(r,o).forEach(function(r){!1===t[r]&&e++}),n[o][r]=4-e},a=0;a<e;a++)i(a);var l=[[0,1],[1,0],],u=function(t,c,o,i){if(t!==e&&c!=r&&!(n[c][t]>2)){2===n[c][t]&&(o[0]++,n[c][t]=-2,i[c][t]=o);for(var a=0;a<l.length;a++){var f=l[a];u(t+f[0],c+f[1],o,i)}}},f=function(t,r){var e=t[1],n=t[0],c=LetterIndex[e],o=LetterIndex[e+1],i=NumberIndex[n],a=NumberIndex[n+1],l="".concat(c+i,",").concat(c).concat(a),u="".concat(c+a,",").concat(o).concat(a),f="".concat(o+i,",").concat(o).concat(a),$="".concat(c+i,",").concat(o).concat(i);switch(r){case DIR.left:return $;case DIR.right:return u;case DIR.top:return l;case DIR.bottom:return f}},$=function(t,r){var e=[DIR.top,DIR.right,DIR.bottom,DIR.left].map(function(r){return f(t,r)});switch(r){case e[0]:break;case e[1]:return DIR.right;case e[2]:return DIR.bottom;case e[3]:return DIR.left}return DIR.top},s=function(t,r){return createAllLinesFromCell(t,r).filter(function(t){return!!c.find(function(r){return t===r})})},_=function(t,r){return s(t,r).map(function(e){return $([t,r],e)}).map(function(e){switch(e){case DIR.top:return[t,r-1];case DIR.bottom:return[t,r+1];case DIR.left:return[t-1,r];case DIR.right:return[t+1,r]}return[t,r]})},I=function(t,c,o){for(;t.length;){var i=t.pop(),a=i[0],l=i[1];a!==e&&l!=r&&!(a<0)&&!(l<0)&&!(n[l][a]>2)&&2===n[l][a]&&(c[0]++,n[l][a]=-2,o[l][a]=c,_(a,l).forEach(function(r){return t.push(r)}))}},v=[];Array(r).fill(0).forEach(function(t,r){v.push(Array(e))});for(var o=0;o<r;o++)for(var a=0;a<e;a++)I([[a,o]],[0],v);for(var D=[],o=0;o<r;o++)for(var a=0;a<e;a++)1===n[o][a]&&D.push([a,o]);for(var d=[],o=0;o<r;o++)for(var a=0;a<e;a++)-2===n[o][a]&&d.push([a,o]);var R=function(t){return t[0]==directions[0][0]&&t[1]==directions[0][1]?DIR.right:t[0]==directions[1][0]&&t[1]==directions[1][1]?DIR.bottom:t[0]==directions[2][0]&&t[1]==directions[2][1]?DIR.top:t[0]==directions[3][0]&&t[1]==directions[3][1]?DIR.left:DIR.top},h={val:-1,dir:R(directions[0]),originCell:[0,0]};D.forEach(function(n){var c,o=n[0],i=n[1],a=createAllLinesFromCell(o,i).filter(function(r){return!0===t[r]})[0],l=$([o,i],a);switch(l){case DIR.right:c=directions[0];break;case DIR.bottom:c=directions[1];break;case DIR.top:c=directions[2];break;case DIR.left:c=directions[3]}var u=o+c[0],f=i+c[1];if(f>-1&&u>-1&&f<r&&u<e){var s=v[f][u];s&&s[0]>h.val&&(h={val:s[0],dir:R(c),originCell:[o,i]})}-1===h.val&&(h={val:0,dir:R(c),originCell:[o,i]})});var m=c[0];if(h.val>-1)m=f(h.originCell,h.dir);else if(D.length){var p=D[0],g=createAllLinesFromCell(p[0],p[1]),b=new Set(Object.keys(t).filter(function(r){return!t[r]}));return g.filter(function(t){return!b.has(t)})[0]}else{var L=d.reduce(function(t,r){return createAllLinesFromCell(r[0],r[1]).forEach(function(r){t.add(r)}),t},new Set),A=c.filter(function(t){return!L.has(t)});if(!(m=A[Math.floor(Math.random()*A.length)])){for(var C={val:Number.MAX_VALUE,cell:[0,0]},o=0;o<r;o++)for(var a=0;a<e;a++)v[o][a]&&v[o][a][0]<C.val&&(C={val:v[o][a][0],cell:[a,o]});C.val!==Number.MAX_VALUE&&(m=s(C.cell[0],C.cell[1])[0])}}return m};
